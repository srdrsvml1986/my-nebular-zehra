<nb-card size="giant" [nbSpinner]="loading" nbSpinnerStatus="primary">
  <nb-card-header>Kullanıcılar</nb-card-header>   
      <nb-list>
        <nb-list-item ngClass="contact" *ngFor="let u of users ">
          <nb-user [picture]="u.photo" [name]="u.firstName + ' ' + u.lastName" [title]="u.email" size="large"></nb-user>
          <div ngClass="user-action-icon">
            <i class="fa-solid fa-pen-to-square" (click)="showUserDialog(editUserDialogTemplate,u)"
              title="Edit user"></i>
            <i class="fa-solid fa-trash" (click)="showUserDialog(deleteUserDialogTemplate,u)" title="User delete"></i>
          </div>
        </nb-list-item>
      </nb-list>   
</nb-card>

<ng-template #editUserDialogTemplate let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>{{'UserForm'| translate}}</nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label for="inputEmail" class="label">Email</label>
            <input type="email" nbInput fullWidth [(ngModel)]="user.email" #email="ngModel" name="email"
              id="input-email" pattern=".+@.+\..+" placeholder="Email address" fieldSize="large" autofocus
              [status]="email.dirty ? (email.invalid  ? 'danger' : 'success') : 'basic'" [required]="true"
              [attr.aria-invalid]="email.invalid && email.touched ? true : null">
            <ng-container *ngIf="email.invalid && email.touched">
              <p class="caption status-danger" *ngIf="email.errors?.['required']">
                Email is required!
              </p>
              <p class="caption status-danger" *ngIf="email.errors?.['pattern']">
                Email should be the real one!
              </p>
            </ng-container>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label for="name" class="label">Adınız</label>
            <input type="text" nbInput fullWidth [(ngModel)]="user.firstName" #firstName="ngModel" name="name"
              id="input-name" placeholder="Adınız" fieldSize="large" autofocus >
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label for="surname" class="label">Soyadınız</label>
            <input type="text" nbInput fullWidth [(ngModel)]="user.lastName" #lastName="ngModel" name="surname"
              id="input-surname" placeholder="Soyadınız" fieldSize="large" autofocus >
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label for="inputpassword" class="label">Yeni Şifreniz</label>
            <input type="password" nbInput fullWidth [(ngModel)]="user.password" #password="ngModel" name="password"
              id="input-password" placeholder="password" fieldSize="large" autofocus >
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label for="inputphoto" class="label">Fotoğraf URL</label>
            <input type="photo" nbInput fullWidth [(ngModel)]="user.photo" #photo="ngModel" name="photo"
              id="input-photo" placeholder="photo URL" fieldSize="large" autofocus >
          </div>
        </div>
      </div>
      <br>
    </nb-card-body>
    <nb-card-footer>
      <button type="submit" nbButton style="margin-right: 3px;" (click)="updateUser(ref)">{{'Save' |translate}}</button>
      <button type="button" (click)="ref.close()" nbButton style="margin-left: 5px;">Kapat</button>
      <div class="clearfix"></div>
    </nb-card-footer>
  </nb-card>
</ng-template>
<ng-template #deleteUserDialogTemplate let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>Kullanıcı Sil</nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-sm-12">
          <div>seçili email:<b> {{user.email}}</b></div>
          <nb-alert outline="danger" role="alert">
            Kullanıcıyı silmek istiyor musun?
          </nb-alert>
        </div>
      </div><br>
      <div style="padding: 3px;">
        <button type="submit" (click)="deleteUser(ref)" nbButton style="margin-right: 3px;">Gönder</button>
        <button type="button" (click)="ref.close()" nbButton style="margin-left: 5px;">Kapat</button>
      </div>
    </nb-card-body>
  </nb-card>
</ng-template>